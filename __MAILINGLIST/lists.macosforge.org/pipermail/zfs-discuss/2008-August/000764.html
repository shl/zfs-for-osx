<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [zfs-discuss] snapshot
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:zfs-discuss%40lists.macosforge.org?Subject=%5Bzfs-discuss%5D%20snapshot&In-Reply-To=CBFE2D23-436C-4F4F-80E9-1249202BBA2E%40spamfreemail.de">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000763.html">
   <LINK REL="Next"  HREF="000765.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[zfs-discuss] snapshot</H1>
    <B>Germano Caronni</B> 
    <A HREF="mailto:zfs-discuss%40lists.macosforge.org?Subject=%5Bzfs-discuss%5D%20snapshot&In-Reply-To=CBFE2D23-436C-4F4F-80E9-1249202BBA2E%40spamfreemail.de"
       TITLE="[zfs-discuss] snapshot">caronni at gmail.com
       </A><BR>
    <I>Sun Aug 10 13:34:32 PDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000763.html">[zfs-discuss] snapshot
</A></li>
        <LI>Next message: <A HREF="000765.html">[zfs-discuss] snapshot
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#764">[ date ]</a>
              <a href="thread.html#764">[ thread ]</a>
              <a href="subject.html#764">[ subject ]</a>
              <a href="author.html#764">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Paint me naive. But if you destroy all snapshots from ruebebackup, what you
are left with is the latest backup you made. All the space referenced by the
old snapshots gets freed when you destroy them. So you loose the ability to
go back in time, but in return you get the space back that is only
referenced in the deleted snapshots.

That's exactly what you want, no?

Germano


On Sun, Aug 10, 2008 at 21:43, ruebezahl &lt;<A HREF="http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss">franzschmalzl at spamfreemail.de</A>&gt;wrote:

&gt;<i> -----BEGIN PGP SIGNED MESSAGE-----
</I>&gt;<i> Hash: SHA1
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> - -----BEGIN PGP SIGNED MESSAGE-----
</I>&gt;<i> Hash: SHA1
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> hi noel!
</I>&gt;<i>
</I>&gt;<i> thank you for your rapid response...
</I>&gt;<i>
</I>&gt;<i> so i read my mail to you again this morning and noticed there was no
</I>&gt;<i> way whatsoever you could understand what i want to ask :)
</I>&gt;<i> sorry, i was tired, let me try again :)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> let my show you a zfs list
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> NAME                     USED  AVAIL  REFER  MOUNTPOINT
</I>&gt;<i> hometank                 117G   297G   796K  /Volumes/hometank
</I>&gt;<i> hometank/meister        54,0M   297G  54,0M  /Volumes/hometank/meister
</I>&gt;<i> hometank/ruebezahl       117G   297G   116G  /Volumes/hometank/ruebezahl
</I>&gt;<i> hometank/<A HREF="http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss">ruebezahl at 1</A>    75,1M      -   116G  -
</I>&gt;<i> raidtank                 635G   280G  57,1M  /Volumes/raidtank
</I>&gt;<i> raidtank/installers      161G   280G   161G  /Volumes/raidtank/
</I>&gt;<i> installers
</I>&gt;<i> raidtank/meisterbackup  54,7M   280G  54,7M  /Volumes/raidtank/
</I>&gt;<i> meisterbackup
</I>&gt;<i> raidtank/movies          347G   280G   347G  /Volumes/raidtank/movies
</I>&gt;<i> raidtank/ruebebackup     116G   280G   116G  /Volumes/raidtank/
</I>&gt;<i> ruebebackup
</I>&gt;<i> raidtank/<A HREF="http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss">ruebebackup at 1</A>  42,6K      -   116G  -
</I>&gt;<i> raidtank/sysbackup      10,9G   280G  10,9G  /Volumes/raidtank/backup
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> my homefolders are on hometank
</I>&gt;<i> my backups are on raidtank together with several other things...
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> i used zfs send hometank/<A HREF="http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss">ruebezahl at 1</A> &gt; blafile
</I>&gt;<i> zfs recv raidtank/ruebebackup &lt; blafile
</I>&gt;<i> and then some incremental sending
</I>&gt;<i>
</I>&gt;<i> let's state i have done this for a while and my raidtank decided to
</I>&gt;<i> fill up
</I>&gt;<i>
</I>&gt;<i> so it would look like this
</I>&gt;<i>
</I>&gt;<i> raidtank/ruebebackup
</I>&gt;<i> raidtank/<A HREF="http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss">ruebebackup at 1</A>
</I>&gt;<i> raidtank/<A HREF="http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss">ruebebackup at 2</A>
</I>&gt;<i> raidtank/<A HREF="http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss">ruebebackup at 3</A>
</I>&gt;<i> raidtank/<A HREF="http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss">ruebebackup at 4</A>
</I>&gt;<i> raidtank/<A HREF="http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss">ruebebackup at 5</A>
</I>&gt;<i> .........
</I>&gt;<i>
</I>&gt;<i> so at this point i could start to delete @1 and @2 and @3 and maybe
</I>&gt;<i> free up about 3 or 4  gigs
</I>&gt;<i> but imagine the original initial backup ruebebackup is so old it does
</I>&gt;<i> not make sense to keep it anymore
</I>&gt;<i>
</I>&gt;<i> how would i manage to promote <A HREF="http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss">ruebebackup at 5</A> to the latest filesystem
</I>&gt;<i> and still be able to resume my incremental backups without having to
</I>&gt;<i> delete everything and start with a new initial backup?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> if i still didn't manage to make a point here:
</I>&gt;<i>
</I>&gt;<i> imagine time machine
</I>&gt;<i>
</I>&gt;<i> backs up initial and then incremental
</I>&gt;<i> harddrive fills up
</I>&gt;<i> deletes oldes backup
</I>&gt;<i> and &quot;rotates&quot; the backups trough time without the need of a now
</I>&gt;<i> initial backup
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> i want to imitate this behaviour
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> best whateverwouldbeappropriateinenglish
</I>&gt;<i>
</I>&gt;<i> ruebezahl :)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ps.
</I>&gt;<i> thanks for your time
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; So if I'm understanding you correctly, you have a bunch of
</I>&gt;<i> &gt;&gt; snapshots of your filesystem, and you want to delete your
</I>&gt;<i> &gt;&gt; filesystem alltogether  and only keep your last snapshot of your
</I>&gt;<i> &gt;&gt; filesystem around for backup purposes incase you want something
</I>&gt;<i> &gt;&gt; from it at some point?
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; If the above is the case, then just use 'zfs send' to send your
</I>&gt;<i> &gt;&gt; snapshot to a file you can store anywhere on your machine, or
</I>&gt;<i> &gt;&gt; another drive.  And no, wherever you save that file, it doesn't
</I>&gt;<i> &gt;&gt; have to be a ZFS filesystem.  So if you had an external firewire
</I>&gt;<i> &gt;&gt; drive with an HFS+ partition on it, you could do
</I>&gt;<i> &gt;&gt; 'zfs send raidtank/<A HREF="http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss">ruebebackup at 7</A> &gt; ruebebackup.out'
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; This will send a complete instantiation of your filesystem to a
</I>&gt;<i> &gt;&gt; file.  Then you can just delete the filesystem and all the
</I>&gt;<i> &gt;&gt; snapshots.  Then if you want to access it, you can use 'zfs recv',
</I>&gt;<i> &gt;&gt; note that in order to receive you do have to receive into a ZFS
</I>&gt;<i> &gt;&gt; pool, since ZFS will rebuild your filesystem just as you left it,
</I>&gt;<i> &gt;&gt; options and all.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; For more related functionality of snapshots you can also look at
</I>&gt;<i> &gt;&gt; 'zfs clone', which given a snapshot will recreate a writeable
</I>&gt;<i> &gt;&gt; version of that snapshot.  You can also use 'zfs promote' if you
</I>&gt;<i> &gt;&gt; decide at some point that you want to promote your clone to your
</I>&gt;<i> &gt;&gt; current 'parent' filesystem.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Is the above information what you're looking for? Or do you have
</I>&gt;<i> &gt;&gt; any other questions?
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Noel
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; On Aug 8, 2008, at 5:18 PM, ruebezahl wrote:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; -----BEGIN PGP SIGNED MESSAGE-----
</I>&gt;<i> &gt;&gt;&gt; Hash: SHA1
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; hey list!
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; i'm having a little understanding issue here
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; look at this
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; raidtank/ruebebackup     116G   280G   116G  /Volumes/raidtank/
</I>&gt;<i> &gt;&gt;&gt; ruebebackup
</I>&gt;<i> &gt;&gt;&gt; raidtank/<A HREF="http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss">ruebebackup at 1</A>  42,6K      -   116G  -
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; let's imagine i used the snapshots for a while to make my backups
</I>&gt;<i> &gt;&gt;&gt; and
</I>&gt;<i> &gt;&gt;&gt; my harddrive started filling up
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; so i would have <A HREF="http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss">ruebebackup at 1</A>,2,3,4,5,6,7 and so on
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; of course i could start to delete some old snapshots but what if the
</I>&gt;<i> &gt;&gt;&gt; ruebebackup itself got so outdated i want to delete it and only keep
</I>&gt;<i> &gt;&gt;&gt; the latest state ( snapshot )
</I>&gt;<i> &gt;&gt;&gt; zfs tells my i can't do that
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; basically i want to simulate time machine behaviour
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; how would i do that ?
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; regards
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; ruebezahl
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; -----BEGIN PGP SIGNATURE-----
</I>&gt;<i> &gt;&gt;&gt; Version: GnuPG v1.4.8 (Darwin)
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; iQEcBAEBAgAGBQJInOJsAAoJEP8ZopU3BhmtTzwH/R0JpPc4wMMo6s8rwfTbzTsU
</I>&gt;<i> &gt;&gt;&gt; xJCIY0IpgRJaygHdQUTc/uBxLpvZaj/VGCnhZcrsObdw2bCfOJtI0mlLtdxeEOsJ
</I>&gt;<i> &gt;&gt;&gt; iSOWsokxP4la65fKORUrEBfcvAFO0cH1CWAhlWEfKLk92RHCTqIqhBI/z1c/L0G+
</I>&gt;<i> &gt;&gt;&gt; fnkJLpQercNsb+mpUXpAkkDbW+cFb827wSLpjhJ8rR20uYvft/alJxSHPBjOGOWc
</I>&gt;<i> &gt;&gt;&gt; J4nrrU7AHL8kP287f7aKjdpz/2j1vivap5P5m+UluKAaQjs/xW623hU3An/2LQfg
</I>&gt;<i> &gt;&gt;&gt; cqTtPbumYRmcq54c4QZqnruXTujPx/pHCa+gPkm/TDrTUHPajS0mubyVvdLSGwA=
</I>&gt;<i> &gt;&gt;&gt; =mIbD
</I>&gt;<i> &gt;&gt;&gt; -----END PGP SIGNATURE-----
</I>&gt;<i> &gt;&gt;&gt; _______________________________________________
</I>&gt;<i> &gt;&gt;&gt; zfs-discuss mailing list
</I>&gt;<i> &gt;&gt;&gt; <A HREF="http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss">zfs-discuss at lists.macosforge.org</A>
</I>&gt;<i> &gt;&gt;&gt; <A HREF="http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss">http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss</A>
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; -----BEGIN PGP SIGNATURE-----
</I>&gt;<i> &gt; Version: GnuPG v1.4.8 (Darwin)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; iQEcBAEBAgAGBQJInUR+AAoJEP8ZopU3BhmtGbIIAKZklNU8QTQGVPFiTUo/dEyR
</I>&gt;<i> &gt; YWagZ67eg0dDdjnzUk6edI3enRmriLwPtuR7Cs4Vr481j3kdKg7+Dy6afUIW4o+L
</I>&gt;<i> &gt; YWTNAkn3gcadWHy++ChLdyUSK4sAuVv6qkvEt6n5rfKcvsOEPqx7IUabIgxjpFYS
</I>&gt;<i> &gt; vt8LblUFXrEao34L/HEaPaqLUT7iErFyZefdti1cbKYjIPC0HC/EEJ0miVojY+HR
</I>&gt;<i> &gt; IpKpYa7ZbNRq2xY0Ws5PbxLrOjhm3DaOCroJFiVn3UwZ0M02Skh+fTtp7SZprEuH
</I>&gt;<i> &gt; Syq2hGbkIzu4xoU3d0SpUr0Eka7pa43JnEgjGIX3p6cI08F6T8eHHyLgQ2NetMk=
</I>&gt;<i> &gt; =DYQF
</I>&gt;<i> &gt; -----END PGP SIGNATURE-----
</I>&gt;<i>
</I>&gt;<i> -----BEGIN PGP SIGNATURE-----
</I>&gt;<i> Version: GnuPG v1.4.8 (Darwin)
</I>&gt;<i>
</I>&gt;<i> iQEcBAEBAgAGBQJIn0TQAAoJEP8ZopU3Bhmt8UIH/0wqRfSdZjVp+Qag9eRyUt3y
</I>&gt;<i> BJT2NkLs1kHAbtPy9yXMnEKebHSoUxcxFl2GBO8vhD4NdYCPTyH1A8DkcWlaNFnK
</I>&gt;<i> 2aSgAyWA0OGOYColL3PadGKSL4aA09bFVMgu5Vky12mJ3JlRblrkV3LJ0vTHXajN
</I>&gt;<i> 6KFesNQWpHmYJd3Cg8aNF9vB/kxf8PiYGqtqZeBgN1DtA3GV3J+mdGaDIbRMv+XS
</I>&gt;<i> vvvHUjrfrqrjL8T6t/u96ZIHRvSNuZTubxTKeXQY8pYExPc0JPrds0JScbpzr9VQ
</I>&gt;<i> p5oICZTvgOvPjekpvKPHWH70iQ8PKtlDXGTkBC/1zRH1FXTitYfZ0MzKXxz09vI=
</I>&gt;<i> =CFek
</I>&gt;<i> -----END PGP SIGNATURE-----
</I>&gt;<i> _______________________________________________
</I>&gt;<i> zfs-discuss mailing list
</I>&gt;<i> <A HREF="http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss">zfs-discuss at lists.macosforge.org</A>
</I>&gt;<i> <A HREF="http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss">http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.macosforge.org/pipermail/zfs-discuss/attachments/20080810/7a6fd240/attachment.html">http://lists.macosforge.org/pipermail/zfs-discuss/attachments/20080810/7a6fd240/attachment.html</A> 
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000763.html">[zfs-discuss] snapshot
</A></li>
	<LI>Next message: <A HREF="000765.html">[zfs-discuss] snapshot
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#764">[ date ]</a>
              <a href="thread.html#764">[ thread ]</a>
              <a href="subject.html#764">[ subject ]</a>
              <a href="author.html#764">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss">More information about the zfs-discuss
mailing list</a><br>
</body></html>
