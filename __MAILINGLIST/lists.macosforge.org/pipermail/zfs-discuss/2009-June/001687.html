<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [zfs-discuss] ZFS and kernel panics
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:zfs-discuss%40lists.macosforge.org?Subject=Re%3A%20%5Bzfs-discuss%5D%20ZFS%20and%20kernel%20panics&In-Reply-To=%3C2A311451-8C6E-4D8D-898D-50145DB662AA%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001686.html">
   <LINK REL="Next"  HREF="001688.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[zfs-discuss] ZFS and kernel panics</H1>
    <B>Alex Blewitt</B> 
    <A HREF="mailto:zfs-discuss%40lists.macosforge.org?Subject=Re%3A%20%5Bzfs-discuss%5D%20ZFS%20and%20kernel%20panics&In-Reply-To=%3C2A311451-8C6E-4D8D-898D-50145DB662AA%40gmail.com%3E"
       TITLE="[zfs-discuss] ZFS and kernel panics">alex.blewitt at gmail.com
       </A><BR>
    <I>Mon Jun 29 16:59:06 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001686.html">[zfs-discuss] Dismantling an array?
</A></li>
        <LI>Next message: <A HREF="001688.html">[zfs-discuss] ZFS and kernel panics
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1687">[ date ]</a>
              <a href="thread.html#1687">[ thread ]</a>
              <a href="subject.html#1687">[ subject ]</a>
              <a href="author.html#1687">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've noticed since 10.5.6 (or 10.5.7) I've been getting kernel panics  
more regularly than I used to before (i.e. not). The symptom is the  
same; a kernel panic which requires rebooting.

At midnight, I have a (potentially raceful) condition of a zpool scrub  
and a zfs snapshot.

@daily  /usr/sbin/zpool scrub Data
@daily  /usr/sbin/zfs snapshot -r <A HREF="http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss">Data at AutoD-</A>`date +&quot;\%F&quot;`

Over the last week, my laptop  (when it's been on over midnight) has  
kernel paniced at exactly midnight. In addition, my Mac Mini (with its  
external disks making up the Data pool) has the same process. The Mac  
Mini tends to barf over midnight, though sometimes not until the early  
hours (presumably, when the ZFS scrub is finishing; it takes a lot  
longer on that box due to the size of data it has to process).

There are no problems with the pool itself; upon reboot, the disk is  
there and a subsequent scrub does not trigger the kernel panic. I can  
go days (on the Mini) without needing this, but the laptop seems to  
have triggered the kernel panic fairly regularly. Of course, crontab  
doesn't run when the machine is off, so I only see this over the  
midnight boundary (like tonight) when I happen to be up.

Has anyone else noticed a lack of stability since applying the 10.5.6  
or 10.5.7 patches? Before then, I never used to get a kernel panic and  
I've been using the same pool continuously since then.

Alex
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001686.html">[zfs-discuss] Dismantling an array?
</A></li>
	<LI>Next message: <A HREF="001688.html">[zfs-discuss] ZFS and kernel panics
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1687">[ date ]</a>
              <a href="thread.html#1687">[ thread ]</a>
              <a href="subject.html#1687">[ subject ]</a>
              <a href="author.html#1687">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss">More information about the zfs-discuss
mailing list</a><br>
</body></html>
