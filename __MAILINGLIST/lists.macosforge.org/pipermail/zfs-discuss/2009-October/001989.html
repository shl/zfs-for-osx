<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [zfs-discuss] iSCSI on ZFS (was Re:  zfs-10a286 ?)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:zfs-discuss%40lists.macosforge.org?Subject=Re%3A%20%5Bzfs-discuss%5D%20iSCSI%20on%20ZFS%20%28was%20Re%3A%20%20zfs-10a286%20%3F%29&In-Reply-To=%3C5A179B4D-9CB4-4888-A5BF-F95697E2C914%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002004.html">
   <LINK REL="Next"  HREF="001990.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[zfs-discuss] iSCSI on ZFS (was Re:  zfs-10a286 ?)</H1>
    <B>Richard Elling</B> 
    <A HREF="mailto:zfs-discuss%40lists.macosforge.org?Subject=Re%3A%20%5Bzfs-discuss%5D%20iSCSI%20on%20ZFS%20%28was%20Re%3A%20%20zfs-10a286%20%3F%29&In-Reply-To=%3C5A179B4D-9CB4-4888-A5BF-F95697E2C914%40gmail.com%3E"
       TITLE="[zfs-discuss] iSCSI on ZFS (was Re:  zfs-10a286 ?)">richard.elling at gmail.com
       </A><BR>
    <I>Fri Oct 23 09:55:00 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002004.html">[zfs-discuss] iSCSI on ZFS (was Re: zfs-10a286 ?)
</A></li>
        <LI>Next message: <A HREF="001990.html">[zfs-discuss] iSCSI on ZFS (was Re:  zfs-10a286 ?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1989">[ date ]</a>
              <a href="thread.html#1989">[ thread ]</a>
              <a href="subject.html#1989">[ subject ]</a>
              <a href="author.html#1989">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Oct 23, 2009, at 9:10 AM, David Ritchie wrote:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> In case anyone's interested I've been doing some more experimenting  
</I>&gt;<i> with iSCSI.
</I>&gt;<i>
</I>&gt;<i> I tried installing OpenSolaris on my MacBook using a spare hard  
</I>&gt;<i> drive in order to see what iSCSI performance would be like with the  
</I>&gt;<i> target running on real hardware. Turns out OpenSolaris runs pretty  
</I>&gt;<i> well on a MacBook.
</I>&gt;<i>
</I>&gt;<i> I used the globalSAN initiator on my Mac Pro to connect to a zvol  
</I>&gt;<i> over GigE. In this way I managed to lower the write performance to  
</I>&gt;<i> &lt;1MB/s - similar to the results Raoul Callaghan gets!!
</I>&gt;<i>
</I>&gt;<i> This isn't great. It surprises me a bit, because going from a VMWare  
</I>&gt;<i> Solaris target on one machine to the globalSAN initiator on another  
</I>&gt;<i> machine got me much better performance than that. Why does running  
</I>&gt;<i> OpenSolaris on real hardware make it that much worse? Is there  
</I>&gt;<i> something much better about the network card in the Mac Pro?  
</I>&gt;<i> (maybe). I guess it would be good to try another initiator, although  
</I>&gt;<i> it seems to be quite expensive for the Atto one.
</I>&gt;<i>
</I>&gt;<i> I got slightly better performance using the MS initiator in Windows  
</I>&gt;<i> XP in VMWare connecting to the Solaris on MacBook - about 2.4MB/s.  
</I>&gt;<i> Still not great.
</I>
Sounds like the Nagle algorithm is showing its ugly side. Check your  
initiators
to see if disabling the Nagle algorithm (TCP_NODELAY) helps.
<A HREF="http://en.wikipedia.org/wiki/Nagle%27s_algorithm">http://en.wikipedia.org/wiki/Nagle%27s_algorithm</A>
  -- richard

&gt;<i> I'm beginning to wonder whether it would be quicker to just mount a  
</I>&gt;<i> file share via AFP or SMB on the client machine (shared from a  
</I>&gt;<i> Solaris box) and put a disk image on it. By mounting the disk image  
</I>&gt;<i> and having my home folder in that I get spotlight coupled with ZFS  
</I>&gt;<i> goodness and reasonable speed. A quick test indicates that works  
</I>&gt;<i> pretty well (serving a sparse disk image via AFP from Mac Pro). I'd  
</I>&gt;<i> have to write some startup script to hook this all up on boot on the  
</I>&gt;<i> client, and point my home folder to the appropriate place, or mount  
</I>&gt;<i> the image over /Users.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -- David
</I>&gt;<i> _______________________________________________
</I>&gt;<i> zfs-discuss mailing list
</I>&gt;<i> <A HREF="http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss">zfs-discuss at lists.macosforge.org</A>
</I>&gt;<i> <A HREF="http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss">http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss</A>
</I>
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002004.html">[zfs-discuss] iSCSI on ZFS (was Re: zfs-10a286 ?)
</A></li>
	<LI>Next message: <A HREF="001990.html">[zfs-discuss] iSCSI on ZFS (was Re:  zfs-10a286 ?)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1989">[ date ]</a>
              <a href="thread.html#1989">[ thread ]</a>
              <a href="subject.html#1989">[ subject ]</a>
              <a href="author.html#1989">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.macosforge.org/mailman/listinfo.cgi/zfs-discuss">More information about the zfs-discuss
mailing list</a><br>
</body></html>
